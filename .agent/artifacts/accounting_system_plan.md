# TRS 경리직원용 정산 시스템 기획서

## 1. 개요

### 1.1 목적
경리직원이 매출/매입 거래 내역을 조회하고, 관련 증빙서류(세금계산서, 등급확인서 등)를 업로드하여 정산 업무를 효율적으로 처리할 수 있는 시스템 구축

### 1.2 사용자
- **역할**: ACCOUNTING (경리직원)
- **주요 업무**: 매출/매입 정산, 세금계산서 발행/수취, 등급확인서 관리

---

## 2. 메뉴 구조

```
정산 시스템 (ACCOUNTING)
├── 대시보드
│   ├── 이번 달 매출 요약
│   ├── 이번 달 매입 요약
│   ├── 미정산 건수
│   └── 최근 정산 내역
│
├── 매출 관리 (고객사 → 우리)
│   ├── 매출 내역 조회
│   │   └── 판매주문(Sales Order) 기반 매출 리스트
│   ├── 세금계산서 발행
│   │   └── 매출 선택 → 세금계산서 생성/업로드
│   └── 수금 관리
│       └── 입금 확인 및 정산 완료 처리
│
├── 매입 관리 (우리 → 공급처)
│   ├── 매입 내역 조회
│   │   └── 발주(Purchase Order) 기반 매입 리스트
│   ├── 세금계산서 수취
│   │   └── 공급처 세금계산서 업로드
│   └── 지급 관리
│       └── 지급 예정/완료 처리
│
├── 문서 관리
│   ├── 세금계산서 목록
│   │   └── 발행/수취 세금계산서 통합 조회
│   └── 등급확인서 목록
│       └── 육류 등급확인서 업로드/조회
│
└── 정산 현황
    ├── 미정산 내역
    └── 정산 완료 내역
```

---

## 3. 기능 상세

### 3.1 대시보드
| 항목 | 설명 |
|------|------|
| 이번 달 매출 | Sales Order 기준 총 매출액 |
| 이번 달 매입 | Purchase Order 기준 총 매입액 |
| 미정산 건수 | 세금계산서 미발행 또는 미수금 건수 |
| 최근 정산 | 최근 5건의 정산 완료 내역 |

### 3.2 매출 내역 조회
| 컬럼 | 설명 |
|------|------|
| 주문번호 | Sales Order ID |
| 고객사명 | Customer 이름 |
| 거래일자 | 출고 완료일 |
| 품목 | 품목명 및 수량 |
| 금액 | 총 금액 (세전/세후) |
| 세금계산서 | 발행 여부 (미발행/발행완료) |
| 수금 상태 | 미수금/수금완료 |

**필터 옵션**:
- 기간 (시작일 ~ 종료일)
- 고객사
- 세금계산서 상태
- 수금 상태

### 3.3 매입 내역 조회
| 컬럼 | 설명 |
|------|------|
| 발주번호 | Purchase Order ID |
| 공급처명 | Supplier 이름 |
| 거래일자 | 입고 완료일 |
| 품목 | 품목명 및 수량 |
| 금액 | 총 금액 (세전/세후) |
| 세금계산서 | 수취 여부 (미수취/수취완료) |
| 지급 상태 | 미지급/지급완료 |

**필터 옵션**:
- 기간 (시작일 ~ 종료일)
- 공급처
- 세금계산서 상태
- 지급 상태

### 3.4 세금계산서 관리
| 기능 | 설명 |
|------|------|
| 매출 세금계산서 발행 | 매출 건 선택 → 세금계산서 PDF 업로드 또는 생성 |
| 매입 세금계산서 수취 | 공급처에서 받은 세금계산서 PDF 업로드 |
| 조회 | 발행/수취 구분, 기간, 거래처별 검색 |

### 3.5 등급확인서 관리
| 기능 | 설명 |
|------|------|
| 업로드 | 육류 등급확인서 이미지/PDF 업로드 |
| 연결 | 특정 발주(PO) 또는 입고 건과 연결 |
| 조회 | 발주번호, 기간, 등급별 검색 |

### 3.6 정산 처리
| 상태 | 설명 |
|------|------|
| 미정산 | 세금계산서 미발행 또는 수금/지급 미완료 |
| 정산 완료 | 세금계산서 처리 + 수금/지급 완료 |

---

## 4. 데이터 모델 확장

### 4.1 기존 모델 활용
- `SalesOrder` - 매출 내역 조회
- `PurchaseOrder` - 매입 내역 조회
- `Customer` - 고객사 정보
- `Supplier` - 공급처 정보

### 4.2 신규 필드 추가 (accountingStore)
```typescript
interface AccountingRecord {
  id: string
  type: 'SALES' | 'PURCHASE'  // 매출/매입 구분
  referenceId: string          // SalesOrder 또는 PurchaseOrder ID
  amount: number              // 금액
  tax: number                 // 세금
  totalAmount: number         // 총액
  
  invoiceStatus: 'PENDING' | 'ISSUED' | 'RECEIVED'  // 세금계산서 상태
  invoiceFile?: string        // 세금계산서 파일 URL
  invoiceDate?: string        // 세금계산서 발행/수취일
  
  paymentStatus: 'PENDING' | 'COMPLETED'  // 수금/지급 상태
  paymentDate?: string        // 수금/지급일
  
  certificateFile?: string    // 등급확인서 파일 URL (매입만 해당)
  
  notes?: string              // 비고
  createdAt: string
  updatedAt: string
}
```

---

## 5. 화면 목록

| 화면 | 경로 | 설명 |
|------|------|------|
| 대시보드 | /accounting | 정산 현황 요약 |
| 매출 내역 | /accounting/sales | 매출 리스트 + 세금계산서 발행 |
| 매입 내역 | /accounting/purchases | 매입 리스트 + 세금계산서 수취 |
| 세금계산서 | /accounting/invoices | 세금계산서 통합 조회 |
| 등급확인서 | /accounting/certificates | 등급확인서 관리 |
| 미정산 내역 | /accounting/pending | 정산 필요 건 필터 |
| 정산 완료 | /accounting/completed | 정산 완료 건 조회 |

---

## 6. 구현 우선순위

### Phase 1 (기본)
1. 매출 내역 조회 화면
2. 매입 내역 조회 화면
3. 대시보드 요약 카드

### Phase 2 (문서 관리)
4. 세금계산서 업로드/조회
5. 등급확인서 업로드/조회

### Phase 3 (정산 처리)
6. 수금/지급 상태 관리
7. 정산 완료 처리 플로우

---

## 7. 다음 단계

기획서 승인 후:
1. `accountingStore.ts` 생성 (데이터 모델)
2. 매출/매입 내역 조회 화면 구현
3. 세금계산서/등급확인서 업로드 기능 추가
