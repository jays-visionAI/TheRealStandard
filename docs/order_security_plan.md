# 주문장 보안 및 고객 온보딩 전략 (Identity Pre-binding)

## 1. 개요
현재의 토큰 기반 주문장 오픈 방식은 누구나 링크만 있으면 접근 가능하여 보안에 취약함. 이를 해결하기 위해 관리자가 주문장 생성 시 수령인의 신원(이메일 또는 카카오 ID)을 사전에 정의하고, 접속 시 해당 계정으로 인증을 강제하는 방식을 도입함.

## 2. 주요 프로세스 (Targeted Order Lock)

### Step 1: 관리자 주문장 생성 (사전 정보 입력)
- 주문서 생성 시 `targetIdentity` (이메일/전화번호) 필드 필수 입력.
- 해당 주문서와 고객사 조직(Organization)을 내부적으로 연결.

### Step 2: 카카오톡 링크 발송
- 생성된 초대 링크를 고객에게 발송.

### Step 3: 고객 접속 및 신원 매칭
- 고객 접속 시 로그인 유도 (구글/카카오).
- 로그인한 계정 정보와 주문서의 `targetIdentity`가 일치하는지 검증.
- 불일치 시 접근 차단.

### Step 4: 자동 회원가입 및 조직 연결 (Onboarding)
- 인증 성공 시 자동으로 계정 생성 및 기존 조직 정보와 1:1 매칭.
- 해당 주문장은 유저의 '내 주문 내역'에 즉시 귀속되어 이후 복사(Repeat) 구매 가능.

## 3. 구현 예정 사항 (카카오 API 인증 이후 추진)
- `OrderSheet` 스키마 수정 (`targetEmail`, `targetPhone` 추가).
- 관리자용 주문서 생성 UI에 수신자 정보 입력 필드 추가.
- `InviteLanding` 및 `B2BOrderGrid`에 인증 여부 및 소속 일치 여부 검증 로직 추가.

## 4. 기대 효과
- **보안 강화**: 지정된 수령인 외 접근 불가능.
- **영업 효율**: 첫 주문을 통한 자연스러운 회원가입 유도 및 반복 구매 툴 제공.
- **데이터 무결성**: 주문-판매-경리 프로세스의 1:1 매칭 보장.
